\* TLC Model Checking Configuration for AuthenticationService
\* Run with: tlc AuthenticationService.tla -config AuthenticationService.cfg

\* ============================================================================
\* CONSTANT DEFINITIONS
\* ============================================================================

CONSTANT
    NULL = NULL
    REFRESH_BUFFER_MINUTES = 5
    MAX_TIME = 30

\* ============================================================================
\* SPECIFICATION
\* ============================================================================

SPECIFICATION Spec

\* ============================================================================
\* SAFETY INVARIANTS
\* ============================================================================

INVARIANT TypeOK
INVARIANT TokenNotUsedAfterExpiry
INVARIANT UserInfoConsistent
INVARIANT CachedTokenImpliesAuth
INVARIANT RefreshingImpliesWasAuthenticated
INVARIANT TokenExpiryInFuture

\* ============================================================================
\* LIVENESS PROPERTIES
\* ============================================================================

PROPERTY EventuallyRefreshOrFail
PROPERTY AuthenticationEventuallyCompletes
PROPERTY RefreshEventuallyCompletes

\* ============================================================================
\* STATE CONSTRAINT
\* ============================================================================

CONSTRAINT
    now <= MAX_TIME
